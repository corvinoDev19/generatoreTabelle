<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Toolkit GdR – Home</title>
<style>
  :root{
    color-scheme: dark;
    --bg:#0a0f14; --panel:#0f1620; --panel2:#0c1620; --ink:#eaf7ff; --muted:#bfe6ff;
    --b1:#1f2a3a; --b2:#2b3a4f; --acc1:#7A00FF; --acc2:#C400FF; --pill:#132034;
    --shadow: 0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.03);
  }
  *{box-sizing:border-box}
  body{margin:0;background:radial-gradient(1200px 800px at 20% -10%, #0e1830 0%, transparent 60%),linear-gradient(180deg,#09121a 0%, #0a0f14 60%, #070c12 100%);color:var(--ink);font:500 15px/1.45 Inter, Segoe UI, Roboto, Arial, sans-serif;}
  .wrap{max-width:1200px;margin:28px auto;padding:0 16px}
  header{display:flex;gap:14px;align-items:flex-start;justify-content:space-between;margin-bottom:14px}
  h1{margin:0;font-size:26px;letter-spacing:.4px}
  .sub{margin:4px 0 0;color:var(--muted);opacity:.9;font-size:13px}
  .bar{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin:14px 0}
  .search{flex:1;min-width:220px;display:flex;align-items:center;gap:8px;background:var(--panel);border:1px solid var(--b1);border-radius:12px;padding:10px 12px;box-shadow:var(--shadow)}
  .search input{flex:1;background:transparent;border:0;outline:none;color:var(--ink);font:500 14px}
  .kbd{font:600 11px/1.1 ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;padding:3px 6px;border:1px solid var(--b2);border-radius:8px;background:#101a28;opacity:.8}
  .pill{padding:6px 10px;border:1px solid var(--b2);border-radius:999px;background:var(--pill);cursor:pointer;user-select:none;transition:.2s}
  .pill:hover{transform:translateY(-1px)}
  .pill[data-active="true"]{border-color:#3a6de0;background:#10213a}
  .grid{display:grid;gap:14px;grid-template-columns:repeat(3,1fr)}
  @media (max-width:1000px){ .grid{grid-template-columns:repeat(2,1fr)} }
  @media (max-width:640px){ .grid{grid-template-columns:1fr} }
  .card{position:relative;display:flex;flex-direction:column;gap:8px;background:linear-gradient(135deg,rgba(122,0,255,.08),rgba(196,0,255,.04)) , var(--panel);border:1px solid var(--b1);border-radius:16px;padding:14px;box-shadow:var(--shadow);transition:transform .18s ease, border-color .18s}
  .card:hover{transform:translateY(-2px);border-color:#35507a}
  .badge{font-size:12px;color:#cfeaff;opacity:.9;border:1px solid var(--b2);background:#0f1b2b;border-radius:999px;padding:2px 8px}
  .title{font-weight:800;font-size:16px;letter-spacing:.2px;display:flex;align-items:center;gap:8px}
  .desc{color:var(--muted);font-size:13px;opacity:.95}
  .row{display:flex;justify-content:space-between;align-items:center;gap:8px}
  .go{margin-left:auto;border:1px solid var(--b2);background:linear-gradient(135deg, #162033, #101a28);border-radius:10px;padding:8px 10px;color:var(--ink);font-weight:700;text-decoration:none;display:inline-flex;align-items:center;gap:8px}
  .go:hover{border-color:#4d79ff}
  .fav{position:absolute;top:10px;right:10px;width:34px;height:34px;border-radius:999px;border:1px solid var(--b2);background:#0e1928;display:grid;place-items:center;cursor:pointer;opacity:.9}
  .fav[data-on="true"]{background:linear-gradient(135deg, rgba(122,0,255,.18), rgba(196,0,255,.18));border-color:#7e3cff}
  .tags{display:flex;flex-wrap:wrap;gap:6px}
  .hr{height:1px;border:0;background:linear-gradient(135deg,var(--acc1),var(--acc2));opacity:.4}
  .filters{display:flex;flex-wrap:wrap;gap:8px}
  .hint{font-size:12px;color:var(--muted);opacity:.9}
  footer{margin:18px 0 10px;color:#a6d9ff;opacity:.8;font-size:12px}
  /* Toggle gestione */
  details{margin-top:18px;background:var(--panel2);border:1px solid var(--b1);border-radius:14px;padding:12px}
  details > summary{cursor:pointer;font-weight:800;letter-spacing:.2px}
  textarea#editor{width:100%;min-height:220px;margin-top:10px;background:#0b1520;color:#cfeaff;border:1px solid var(--b2);border-radius:12px;padding:10px;font:500 13px/1.4 ui-monospace,Consolas,monospace}
  .btn{border:1px solid var(--b2);background:#132034;color:var(--ink);border-radius:10px;padding:8px 12px;cursor:pointer}
  .btn:hover{background:#1a2a42}
  .right{margin-left:auto}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Toolkit GdR – Home</h1>
        <p class="sub">Apertura rapida dei tuoi editor e generatori. Cerca, filtra, aggiungi ai preferiti ⭐</p>
      </div>
    </header>

    <div class="bar">
      <div class="search" title="Cerca tra i tool (premi /)">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.2-4.2M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="#7feaff" stroke-width="1.4" stroke-linecap="round"/></svg>
        <input id="q" placeholder="Cerca per nome o descrizione…">
        <span class="kbd">/</span>
      </div>

      <div class="filters" id="filters">
        <div class="pill" data-filter="all" data-active="true">Tutti</div>
        <div class="pill" data-filter="editor">Editor</div>
        <div class="pill" data-filter="generatore">Generatori</div>
        <div class="pill" data-filter="forumfree">ForumFree</div>
        <div class="pill" data-filter="utility">Utility</div>
        <div class="pill" data-filter="preferiti">⭐ Preferiti</div>
      </div>
    </div>

    <div id="grid" class="grid"></div>

    <details>
      <summary>⚙️ Gestione voci (JSON) – aggiungi/rinomina/aggiorna link</summary>
      <p class="hint">Modifica l’elenco e premi <b>Salva</b>. Il contenuto viene salvato in <code>localStorage</code>. Campi: <code>id, title, desc, href, tag, icon</code>. I tag guidano i filtri sopra.</p>
      <textarea id="editor"></textarea>
      <div style="display:flex;gap:8px;margin-top:10px">
        <button id="save" class="btn">Salva</button>
        <button id="reset" class="btn">Ripristina default</button>
        <span id="saved" class="hint right" style="display:none">Salvato ✅</span>
      </div>
    </details>

    <footer>Suggerimento: clicca ⭐ su una card per aggiungere ai preferiti. Filtra con “⭐ Preferiti”.</footer>
  </div>

<script>
(() => {
  const el = s => document.querySelector(s);
  const grid = el('#grid');
  const q = el('#q');
  const savedSpan = el('#saved');
  const STORAGE_LIST = 'toolkit_list_v1';
  const STORAGE_FAVS = 'toolkit_favs_v1';

  // ===== Default tools (sostituisci href con i tuoi file reali) =====
  const DEFAULT_TOOLS = [
    {
      id:'hppe',
      title:'HP/PE – Snippet inline',
      desc:'Generatore barre PV/PE in una riga, libreria schede JSON, anteprima live.',
      href:'generatore_barre_hp_pe.html	',
      tag:['generatore','forumfree'],
      icon:'💊'
    },
    {
      id:'tecnica',
      title:'Tecnica singola',
      desc:'Editor Quill per stile, valori, galleria GIF e librerie JSON.',
      href:'tecncia.html',
      tag:['editor','forumfree'],
      icon:'🧩'
    },
    {
      id:'scheda',
      title:'Editor Scheda GdR',
      desc:'Editor verticale con salvataggio, JSON e autosave.',
      href:'tabella.html',
      tag:['editor','forumfree'],
      icon:'📝'
    },
    {
      id:'elite',
      title:'Generatore HomeTopic',
      desc:'Tool responsive per layout avanzati + tema completo.',
      href:'homepage.html',
      tag:['generatore','forumfree'],
      icon:'🏆'
    },
    {
      id:'resoconto',
      title:'Generatore Resoconto',
      desc:'Costruisci schede resoconto e salva/riapri in JSON dedicato.',
      href:'generatore_scheda_resoconto.html',
      tag:['generatore','editor'],
      icon:'📦'
    },  
  
  ];

  // ===== State =====
  let tools = loadTools();
  let favs = loadFavs();
  render();
  fillEditor();

  // ===== Rendering =====
  function render(){
    const term = (q.value || '').trim().toLowerCase();
    const activeFilter = document.querySelector('.pill[data-active="true"]')?.dataset.filter || 'all';
    grid.innerHTML = tools.map(t => {
      const inSearch = !term || (t.title + ' ' + t.desc).toLowerCase().includes(term);
      const inFilter = filterMatch(t, activeFilter);
      const favOn = !!favs[t.id];
      if(!(inSearch && inFilter)) return '';
      return cardHTML(t, favOn);
    }).join('') || emptyHTML(term, activeFilter);
    bindCardEvents();
  }

  function cardHTML(t, favOn){
    return `
    <article class="card" data-id="${t.id}">
      <button class="fav" data-on="${favOn? 'true':'false'}" title="${favOn?'Rimuovi dai preferiti':'Aggiungi ai preferiti'}">⭐</button>
      <div class="title"><span style="font-size:20px">${t.icon||'🧷'}</span> <span>${escapeHtml(t.title)}</span></div>
      <div class="desc">${escapeHtml(t.desc)}</div>
      <div class="row">
        <div class="tags">${(t.tag||[]).map(x=>`<span class="badge">${escapeHtml(x)}</span>`).join(' ')}</div>
        <a class="go" href="${t.href}" target="_blank" rel="noopener">Apri <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M7 17l10-10M9 7h8v8" stroke="#cfeaff" stroke-width="1.6" stroke-linecap="round"/></svg></a>
      </div>
    </article>`;
  }

  function emptyHTML(term, filter){
    const msg = term ? `Nessun risultato per “${escapeHtml(term)}”.` : `Nessun elemento nel filtro “${escapeHtml(filter)}”.`;
    return `<div class="card"><div class="title">😶‍🌫️ Niente da mostrare</div><div class="desc">${msg}</div></div>`;
  }

  function bindCardEvents(){
    grid.querySelectorAll('.fav').forEach(btn=>{
      btn.addEventListener('click', (e)=>{
        e.preventDefault();
        e.stopPropagation();
        const art = btn.closest('.card');
        const id = art.dataset.id;
        const on = btn.getAttribute('data-on') === 'true';
        if(on){ delete favs[id]; } else { favs[id]=true; }
        saveFavs();
        btn.setAttribute('data-on', !on);
        // se filtro su preferiti, rinfresca
        const activeFilter = document.querySelector('.pill[data-active="true"]')?.dataset.filter || 'all';
        if(activeFilter==='preferiti') render();
      });
    });
  }

  // ===== Filters =====
  function filterMatch(t, f){
    if(f==='all') return true;
    if(f==='preferiti') return !!favs[t.id];
    return (t.tag||[]).includes(f);
  }

  document.querySelectorAll('#filters .pill').forEach(p=>{
    p.addEventListener('click', ()=>{
      document.querySelectorAll('#filters .pill').forEach(x=>x.dataset.active='false');
      p.dataset.active = 'true';
      render();
    });
  });

  // ===== Search =====
  q.addEventListener('input', render);
  window.addEventListener('keydown', e=>{
    if(e.key === '/'){ e.preventDefault(); q.focus(); }
  });

  // ===== Editor JSON =====
  function fillEditor(){
    el('#editor').value = JSON.stringify(tools, null, 2);
  }
  el('#save').addEventListener('click', ()=>{
    try{
      const parsed = JSON.parse(el('#editor').value);
      if(!Array.isArray(parsed)) throw new Error('Il JSON deve essere un array di oggetti.');
      tools = sanitizeList(parsed);
      saveTools();
      savedSpan.style.display='inline';
      setTimeout(()=>savedSpan.style.display='none', 1200);
      render();
    }catch(err){
      alert('Errore nel JSON: ' + err.message);
    }
  });
  el('#reset').addEventListener('click', ()=>{
    if(!confirm('Ripristinare la lista predefinita?')) return;
    tools = DEFAULT_TOOLS.slice();
    saveTools();
    fillEditor();
    render();
  });

  // ===== Storage =====
  function loadTools(){
    try{
      const raw = localStorage.getItem(STORAGE_LIST);
      if(!raw) return DEFAULT_TOOLS.slice();
      const parsed = JSON.parse(raw);
      return sanitizeList(parsed);
    }catch{ return DEFAULT_TOOLS.slice(); }
  }
  function saveTools(){
    try{ localStorage.setItem(STORAGE_LIST, JSON.stringify(tools)); }catch{}
  }
  function loadFavs(){
    try{
      return JSON.parse(localStorage.getItem(STORAGE_FAVS) || '{}') || {};
    }catch{ return {}; }
  }
  function saveFavs(){
    try{ localStorage.setItem(STORAGE_FAVS, JSON.stringify(favs)); }catch{}
  }

  // ===== Utils =====
  function sanitizeList(list){
    return list.map(x=>({
      id: String(x.id||cryptoRandom()),
      title: String(x.title||'Senza titolo'),
      desc: String(x.desc||''),
      href: String(x.href||'#'),
      tag: Array.isArray(x.tag) ? x.tag : [],
      icon: String(x.icon||'🧷')
    }));
  }
  function escapeHtml(s){
    return String(s).replace(/[&<>"]/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;' }[c]));
  }
  function cryptoRandom(){
    try{ return crypto.getRandomValues(new Uint32Array(1))[0].toString(36); }
    catch{ return Math.random().toString(36).slice(2); }
  }
})();
</script>
</body>
</html>
